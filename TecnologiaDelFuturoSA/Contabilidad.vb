Public Class Contabilidad
    Public Function CalcularNeto(ByVal bruto As Double, hoy As Date, h As Integer) As Double
        Dim SalarioNeto, devengos, deducciones As Double

        devengos = Me.Vacaciones(bruto) + Me.CalcularExtras(h, bruto)
        deducciones = Me.Medico(bruto) + Me.INSS(bruto)

        If hoy.Month = 11 Then

            devengos += Me.Aguinaldo(bruto, hoy)

        End If

        SalarioNeto = (bruto + devengos) - deducciones

        If SalarioNeto > 12000 Then

            SalarioNeto -= Me.Renta(bruto)

        End If
        Return Math.Round(SalarioNeto, 2)
    End Function

    Public Function CalcularExtras(ByVal horas As Integer, ByVal bruto As Double) As Double
        Dim extra, pago As Double

        extra = ((bruto / 30) / 8) * 2
        pago = horas * extra
        
        Return Math.Round(pago, 2)
    End Function

    Public Function Medico(ByVal bruto As Double)
        Medico = (bruto * 4) / 100
        Return Math.Round(Medico, 2)
    End Function

    Public Function INSS(ByVal bruto As Double)
        INSS = (bruto * 6.25) / 100
        Return Math.Round(INSS, 2)
    End Function

    Public Function Vacaciones(ByVal bruto As Double)
        Vacaciones = (bruto / 30) * 2.5

        Return Math.Round(Vacaciones, 2)
    End Function

    Public Function Renta(ByVal bruto As Double)
        If bruto > 12000 Then
            Renta = (bruto * 6) / 100
            Return Math.Round(Renta, 2)
        Else
            Renta = 0
        End If
        Return Math.Round(Renta, 2)
    End Function

    Public Function Aguinaldo(ByVal bruto As Double, d As Date)
        If d.Month = 11 Then
            Aguinaldo = (bruto / 30) * 2.5

        Else
            Aguinaldo = 0

        End If
        Return Math.Round(Aguinaldo, 2)

    End Function

End Class




























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































